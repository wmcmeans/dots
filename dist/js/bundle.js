!function(e){function t(i){if(o[i])return o[i].exports;var n=o[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var o={};return t.m=e,t.c=o,t.p="/dist/js/",t(0)}([function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=o(1),s=i(n),r=o(5);document.addEventListener("DOMContentLoaded",function(){var e=(0,r.queryEl)("#spots-game"),t=new s.default(e);t.start(),(0,r.queryEl)("#new-game-btn").addEventListener("click",function(){return window.location.reload()})})},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=o(2),a=i(r),c=o(4),u=o(5),l=function(){function e(t){n(this,e),this.xDim=t.offsetWidth,this.yDim=t.offsetHeight,this.ctx=t.getContext("2d"),(0,u.fixCanvasBlur)(t),this.trackCursor(),this.board=new a.default,this.setupScoreBoard(),this.setupGameOverText()}return s(e,[{key:"addBorderAndBG",value:function(){this.board.squared?(document.body.style.backgroundColor=(0,u.getColorAtReducedOpacity)(this.board.moveColor,.25),document.body.style.borderColor=(0,u.getColorAtReducedOpacity)(this.board.moveColor)):(document.body.style.backgroundColor="",document.body.style.borderColor="transparent")}},{key:"beginMove",value:function(){this.moving=!0,this.board.beginMove(this.cursorPos)}},{key:"clearCanvas",value:function(){this.ctx.clearRect(0,0,this.xDim,this.yDim)}},{key:"displayGameOverText",value:function(){var e=this;this.endGameDom.highScoreTextNodes.forEach(function(t){return t.textContent=e.highScore}),this.endGameDom.thisScoreTextNode.textContent=this.score,this.newHighScore?this.endGameDom.gameOverText.classList.add("new-high-score"):this.endGameDom.gameOverText.classList.remove("new-high-score"),this.endGameDom.canvasContainer.classList.add("game-over")}},{key:"end",value:function(){this.over=!0,this.updateHighScoreIfBeaten(),this.displayGameOverText()}},{key:"endMove",value:function(){this.moving=!1;var e=this.board.endMove();e&&this.updateScore(e),0===this.movesLeft&&this.end()}},{key:"render",value:function(e){this.ctx.clearRect(0,0,this.xDim,this.yDim),this.addBorderAndBG(),this.board.draw(this.ctx,this.cursorPos,e)}},{key:"setupGameOverText",value:function(){this.endGameDom={canvasContainer:(0,u.queryEl)("#canvas-container"),gameOverText:(0,u.queryEl)("#game-over-text"),highScoreTextNodes:(0,u.queryElAll)(".high-score-text"),thisScoreTextNode:(0,u.queryEl)("#this-score-text")}}},{key:"setupScoreBoard",value:function(){this.gameTracker={score:(0,u.queryEl)("#score"),movesLeft:(0,u.queryEl)("#moves-left")},this.score=0,this.movesLeft=31,this.updateScore()}},{key:"start",value:function(){var e=this,t=function t(o){var i=o-e.lastTime;e.lastTime=o,e.render(i),e.over?e.clearCanvas():window.requestAnimationFrame(t)};t(0),this.trackMoves()}},{key:"trackCursor",value:function(){var e=this;this.cursorPos={x:0,y:0};var t=function(t){return e.cursorPos=(0,u.getCursorPos)(e.ctx.canvas,t)},o=function(t){return e.cursorPos=(0,u.getTouchPos)(e.ctx.canvas,t)};document.addEventListener("mousemove",t),document.addEventListener("touchmove",o)}},{key:"trackMoves",value:function(){var e=this,t=function(){return e.beginMove()},o=function(t){e.cursorPos=(0,u.getTouchPos)(e.ctx.canvas,t),e.beginMove()};this.ctx.canvas.addEventListener("mousedown",t),this.ctx.canvas.addEventListener("touchstart",o);var i=function(){return e.endMove()};window.addEventListener("mouseup",i),window.addEventListener("touchend",i)}},{key:"updateHighScoreIfBeaten",value:function(){this.highScore=parseInt(localStorage.getItem(c.HIGH_SCORE),10),this.newHighScore=!1,(this.score>this.highScore||Number.isNaN(this.highScore))&&(this.newHighScore=!0,this.highScore=this.score,localStorage.setItem(c.HIGH_SCORE,this.score))}},{key:"updateScore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.score+=e,this.movesLeft-=1,this.gameTracker.score.textContent=this.score,this.gameTracker.movesLeft.textContent=this.movesLeft}}]),e}();t.default=l},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=o(3),a=i(r),c=o(6),u=i(c),l=o(5),h=function(){function e(){n(this,e),this.selectedSpots=[],this.lines=[],this.moveColor=void 0,this.setup()}return s(e,[{key:"addAllSpotsOfColorToMove",value:function(){var e=this,t=this.selectedSpots[0]&&this.selectedSpots[0].color;this.grid.forEach(function(o){o.forEach(function(o){o.color!==t||e.selectedSpots.find(function(e){return e===o})||e.selectedSpots.push(o)})})}},{key:"addSpotToMove",value:function(e){e.setActive();var t=new u.default(e);this.selectedSpots.length&&(this.getTailSpot().setInactive(),this.getTailLine().forgeConnection(e)),this.selectedSpots.push(e),this.lines.push(t)}},{key:"beginMove",value:function(e){this.moving=!0;var t=this.findActiveSpot(e);t?this.addSpotToMove(t):this.endMove()}},{key:"cancelMove",value:function(){this.selectedSpots.forEach(function(e){return e.setInactive()}),this.clearMove()}},{key:"checkForNewConnections",value:function(e){var t=this.findActiveSpot(e),o=this.getTailSpot();if(t&&t!==o&&o.canConnectWith(t)){var i=this.lines.find(function(e){var i=e.startSpot,n=e.endSpot;return i===o&&n===t||i===t&&n===o}),n=this.getSpotBeforeTail();n&&n===t?(this.removeLastConnection(),this.checkForSquares()):i||(this.addSpotToMove(t),this.checkForSquares())}}},{key:"checkForSquares",value:function(){var e=this,t=new Set,o=!1;this.lines.forEach(function(e){var i=e.startSpot,n=i.pos.x+"-"+i.pos.y;t.has(n)&&(o=!0),t.add(n)}),this.moveColor=this.selectedSpots[0]&&this.selectedSpots[0].color,this.grid.forEach(function(t){t.forEach(function(t){t.color===e.moveColor&&o?t.setActive():e.selectedSpots.find(function(e){return e===t})||t.setInactive()})}),this.squared=o}},{key:"clearMove",value:function(){this.selectedSpots=[],this.lines=[]}},{key:"draw",value:function(e,t,o){var i=this;this.squareSize=e.canvas.offsetWidth/this.grid.length,this.moving&&this.checkForNewConnections(t),this.grid.forEach(function(n){return n.forEach(function(n){return n.draw(e,i.squareSize,t,o)})}),this.lines.forEach(function(o){return o.draw(e,t)})}},{key:"endMove",value:function(){return this.moving=!1,this.selectedSpots.length>1?this.tallyAndRemoveSpots():this.cancelMove()}},{key:"findActiveSpot",value:function(e){for(var t=0;t<this.grid.length;t++)for(var o=0;o<this.grid[0].length;o++){var i=this.grid[t][o];if(i.isMouseOver(e))return i}return null}},{key:"getTailLine",value:function(){return this.lines[this.lines.length-1]}},{key:"getTailSpot",value:function(){return this.selectedSpots[this.selectedSpots.length-1]}},{key:"getSpotBeforeTail",value:function(){return this.selectedSpots.length<2?null:this.selectedSpots[this.selectedSpots.length-2]}},{key:"removeLastConnection",value:function(){this.selectedSpots.pop(),this.lines.pop();var e=this.lines[this.lines.length-1];e.endSpot&&e.destroyConnection()}},{key:"setup",value:function(){this.grid=[];for(var e=0;e<6;e++){for(var t=[],o=0;o<6;o++){var i=new a.default({pos:{x:o,y:e},color:(0,l.randomColor)()});t.push(i)}this.grid.push(t)}}},{key:"tallyAndRemoveSpots",value:function(){var e=this;this.squared&&this.addAllSpotsOfColorToMove(),this.squared=!1;var t=this.selectedSpots.length;return this.selectedSpots.forEach(function(t){var o=t.pos,i=o.x,n=o.y;e.grid[n][i]=null;for(var s=n;s>0;s--)e.grid[s][i]=e.grid[s-1][i],e.grid[s-1][i]=null,e.grid[s][i].pos.y=s,e.grid[s][i]&&e.grid[s][i].animateFromPreviousHeight(s-1);var r={x:i,y:0},c=new a.default({pos:r,color:(0,l.randomColor)()});e.grid[0][i]=c,c.animateFromPreviousHeight(-1)}),this.clearMove(),t}}]),e}();t.default=h},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var o=[],i=!0,n=!1,s=void 0;try{for(var r,a=e[Symbol.iterator]();!(i=(r=a.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){n=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw s}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=o(4),a=o(5),c=function(){function e(t){var o=t.pos,n=t.color;i(this,e),this.pos=o,this.color=n,this.setInactive()}return s(e,[{key:"setCanvasPosForAnimationDown",value:function(e,t){this.downwardAnimation+=.004*t;var o=this.previousY*e+e/2,i=this.pos.y*e+e/2,n=i-o;this.downwardAnimation<1?this.canvasPos.cy=o+n*this.downwardAnimation:(this.downwardAnimation=void 0,this.previousY=void 0)}},{key:"canConnectWith",value:function(e){var t=this.isNeighboring(e.pos),o=this.color===e.color;return t&&o}},{key:"draw",value:function(e,t,o,i){this.setCanvasPos(t),"undefined"!=typeof this.downwardAnimation&&this.setCanvasPosForAnimationDown(t,i),this.isHead&&!this.isMouseOver(o)&&this.setInactive(),e.fillStyle=this.color,e.beginPath(),e.arc(this.canvasPos.cx,this.canvasPos.cy,this.canvasPos.radius,0,2*Math.PI),e.fill(),this.pulsing&&(this.increasePulse(i),this.drawPulse(e,i))}},{key:"drawPulse",value:function(e){e.fillStyle=(0,a.getColorAtReducedOpacity)(this.color,this.pulseOpacity),e.beginPath(),e.arc(this.canvasPos.cx,this.canvasPos.cy,this.pulseRadius,0,2*Math.PI),e.fill()}},{key:"increasePulse",value:function(e){this.pulseRadius+=.08*e,this.pulseOpacity-=.001*e,this.pulseOpacity<0&&(this.pulsing=!1)}},{key:"isNeighboring",value:function(e){var t=this;return Object.entries(r.DELTAS).find(function(o){var i=n(o,2),s=i[0],r=i[1],a=r.x,c=r.y;return t.pos.x+a===e.x&&t.pos.y+c===e.y&&s})}},{key:"pulse",value:function(){this.pulsing=!0,this.pulseRadius=this.canvasPos.radius,this.pulseOpacity=.5}},{key:"setActive",value:function(){this.isHead=!0,this.radiusPct=.25,this.pulse()}},{key:"setCanvasPos",value:function(e){this.canvasPos={cx:this.pos.x*e+e/2,cy:this.pos.y*e+e/2,radius:e*this.radiusPct}}},{key:"setInactive",value:function(){this.isHead=!1,this.radiusPct=.22}},{key:"animateFromPreviousHeight",value:function(e){"undefined"==typeof this.downwardAnimation?(this.previousY=e,this.downwardAnimation=1e-4):this.previousY<0&&(this.previousY-=1)}},{key:"isMouseOver",value:function(e){var t=e.x-this.canvasPos.cx,o=e.y-this.canvasPos.cy;return t*t+o*o<=this.canvasPos.radius*this.canvasPos.radius}}]),e}();t.default=c},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=t.COLORS={PURPLE:"rgba(157, 90, 184, 1)",GREEN:"rgba(138, 237, 145, 1)",BLUE:"rgba(138, 189, 255, 1)",RED:"rgba(241, 92, 59, 1)",YELLOW:"rgba(231, 221, 0, 1)"};t.COLORS_ARRAY=Object.values(o),t.DELTAS={top:{x:0,y:1},right:{x:1,y:0},bottom:{x:0,y:-1},left:{x:-1,y:0}},t.HIGH_SCORE="spots-high-score"},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getColorAtReducedOpacity=t.getTouchPos=t.getCursorPos=t.fixCanvasBlur=t.getOppositeDelta=t.randomColor=t.queryElAll=t.queryEl=void 0;var i=o(4);t.queryEl=function(e){return document.querySelector(e)},t.queryElAll=function(e){return document.querySelectorAll(e)},t.randomColor=function(){var e=Math.floor(5*Math.random());return i.COLORS_ARRAY[e]},t.getOppositeDelta=function(e){switch(e){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right";default:throw new Error("delta not found in list of deltas")}},t.fixCanvasBlur=function(e){var t=e.getContext("2d"),o=window.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,n=o/i;if(o!==i){var s=e.width,r=e.height;if(e.width>1.1*window.innerWidth){var a=window.innerWidth/(1.1*e.width);s*=a,r*=a}e.width=s*n,e.height=r*n,e.style.width=s+"px",e.style.height=r+"px",t.scale(n,n)}},t.getCursorPos=function(e,t){t.preventDefault(),t.stopPropagation();var o=t.clientX-e.offsetLeft,i=t.clientY-e.offsetTop;return{x:o,y:i}},t.getTouchPos=function(e,t){t.preventDefault(),t.stopPropagation();var o=t.touches[0]||t.changedTouches[0],i=o.clientX-e.offsetLeft,n=o.clientY-e.offsetTop;return{x:i,y:n}},t.getColorAtReducedOpacity=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,o=e.length-2;return""+e.slice(0,o)+t+")"}},function(e,t){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),n=function(){function e(t){o(this,e),this.startSpot=t}return i(e,[{key:"destroyConnection",value:function(){this.endSpot=void 0}},{key:"draw",value:function(e,t){e.strokeStyle=this.startSpot.color,e.lineWidth=12*(e.canvas.width/1200),e.beginPath(),e.moveTo(this.startSpot.canvasPos.cx,this.startSpot.canvasPos.cy),this.endSpot?e.lineTo(this.endSpot.canvasPos.cx,this.endSpot.canvasPos.cy):e.lineTo(t.x,t.y),e.stroke()}},{key:"forgeConnection",value:function(e){this.endSpot=e}}]),e}();t.default=n}]);
//# sourceMappingURL=bundle.js.map